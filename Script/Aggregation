-- find total customers by countries
Select country,
Count(customer_key) as total_customers
from gold.dim_customers
Group by country
Order by total_customers desc

-- find the total customers by genders 
Select gender,
Count(customer_key) as total_customers
from gold.dim_customers
Group by gender
Order by total_customers desc

-- what is the average costs in each category?
select category,
Avg(cost) as Total_numbers
from gold.dim_products
Group by category 
Order by Total_numbers desc

-- what is the total revenue generated for each category?
Select 
p.category ,
Sum(f.Sales_amount) as Total_revenue
from gold.fact_sales f 
left join gold.dim_products p
ON p.product_key = f.product_key 
Group by p.category
Order by Total_revenue desc

-- find total revenue is generated by each customer
select 
c.customer_key,
c.first_name,
c.last_name,
sum(f.Sales_amount) as Total_Revenue 
from  gold.fact_sales f  left join 
 gold.dim_customers c 
on c.customer_key = f.customer_key
Group by c.customer_key, c.first_name,c.last_name
Order by Total_Revenue desc

-- what is the distribution of sold item across each countries?
select 
c.country,
sum(f.quantity) as Total_item_sold 
from  gold.fact_sales f  left join 
 gold.dim_customers c 
on c.customer_key = f.customer_key
Group by c.customer_key, c.country
Order by Total_item_sold desc
